<!DOCTYPE html>

<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Roasty - Profil Pengguna</title>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#f26c0d",
                        "background-light": "#f8f7f5",
                        "background-dark": "#221710",
                        "surface-light": "#ffffff",
                        "surface-dark": "#2a1e16",
                        "text-main-light": "#1c130d",
                        "text-main-dark": "#f4ece7",
                        "text-sub-light": "#9c6c49",
                        "text-sub-dark": "#bda088",
                        "border-light": "#f4ece7",
                        "border-dark": "#3e2b22",
                    },
                    fontFamily: {
                        "display": ["Plus Jakarta Sans", "sans-serif"]
                    },
                    borderRadius: { "DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px" },
                },
            },
        }
    </script>
</head>
<body class="bg-background-light dark:bg-background-dark font-display antialiased transition-colors duration-200">
<!-- Top Navigation Bar -->
<header class="sticky top-0 z-50 w-full bg-surface-light dark:bg-surface-dark border-b border-border-light dark:border-border-dark shadow-sm">
<div class="max-w-[1280px] mx-auto px-4 sm:px-6 lg:px-8">
<div class="flex items-center justify-between h-16 gap-4 sm:gap-8">
<!-- Logo -->
<div class="flex items-center gap-2 text-primary shrink-0">
<div class="size-8 text-primary">
<svg class="h-8 w-8" fill="none" viewbox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
<path d="M24 4C25.7818 14.2173 33.7827 22.2182 44 24C33.7827 25.7818 25.7818 33.7827 24 44C22.2182 33.7827 14.2173 25.7818 4 24C14.2173 22.2182 22.2182 14.2173 24 4Z" fill="currentColor"></path>
</svg>
</div>
<h1 class="text-2xl font-bold tracking-tight text-text-main-light dark:text-text-main-dark hidden sm:block">Roasty</h1>
</div>
<!-- Search Bar -->
<div class="flex-1 max-w-2xl hidden md:block">
<div class="relative group">
<div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-text-sub-light dark:text-text-sub-dark">
<span class="material-symbols-outlined">search</span>
</div>
<input class="block w-full rounded-lg border-none bg-background-light dark:bg-background-dark py-2.5 pl-10 pr-3 text-sm placeholder:text-text-sub-light dark:placeholder:text-text-sub-dark focus:ring-2 focus:ring-primary text-text-main-light dark:text-text-main-dark" placeholder="Cari di Roasty" type="text"/>
</div>
</div>
<!-- Right Actions -->
<div class="flex items-center gap-2 sm:gap-6">
<nav class="hidden lg:flex items-center gap-6">
<a class="text-sm font-medium text-text-main-light dark:text-text-main-dark hover:text-primary transition-colors" href="#">Kategori</a>
<a class="text-sm font-medium text-text-main-light dark:text-text-main-dark hover:text-primary transition-colors" href="#">Belanja</a>
<a class="text-sm font-medium text-text-main-light dark:text-text-main-dark hover:text-primary transition-colors" href="#">Promo</a>
</nav>
<div class="flex items-center gap-2 border-l border-border-light dark:border-border-dark pl-2 sm:pl-6">
<button class="relative p-2 text-text-main-light dark:text-text-main-dark hover:bg-background-light dark:hover:bg-background-dark rounded-full transition-colors">
<span class="material-symbols-outlined text-[24px]">shopping_cart</span>
<span class="absolute top-1 right-1 h-2 w-2 rounded-full bg-primary ring-2 ring-white dark:ring-surface-dark"></span>
</button>
<button class="relative p-2 text-text-main-light dark:text-text-main-dark hover:bg-background-light dark:hover:bg-background-dark rounded-full transition-colors">
<span class="material-symbols-outlined text-[24px]">notifications</span>
</button>
</div>
<div class="h-9 w-9 rounded-full bg-cover bg-center border-2 border-white dark:border-surface-dark shadow-sm cursor-pointer" data-alt="User profile picture" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuDPIkiPSA2lIE8b4HqqpXfRUJQ0y2PLnDhby6bMNf-BRAP3iLs2lXwv7ilMZParqEaILRzzpcgV7nexux0wO0CMCqtseMgnF7h1wNqS49bWJ5FfIEQ54zKX9cIiZe-Izapsd7kQWA9WWoj8QWFe6vVyJ8dwGUV_l2kH5i1crpUNVgnsyHEK3dW2JdnE4BUaBo7P0OJ0DH2Hmm-rzXXdI1Q8a894Ut76gfSX4pn1SrgL4DG23fOY0ND1m32ZB3U1B3adaDPkKhUagg");'></div>
</div>
</div>
</div>
</header>
<!-- Main Layout -->
<main class="max-w-[1280px] mx-auto px-4 sm:px-6 lg:px-8 py-6">
<!-- Breadcrumbs -->
<nav class="flex mb-6 text-sm font-medium text-text-sub-light dark:text-text-sub-dark">
<a class="hover:text-primary" href="#">Home</a>
<span class="mx-2">/</span>
<a class="hover:text-primary" href="#">Akun</a>
<span class="mx-2">/</span>
<span class="text-text-main-light dark:text-text-main-dark font-semibold">Profil Saya</span>
</nav>
<div class="flex flex-col lg:flex-row gap-6">
<!-- Sidebar -->
<aside class="w-full lg:w-64 flex-shrink-0">
<div class="bg-surface-light dark:bg-surface-dark rounded-xl shadow-sm border border-border-light dark:border-border-dark overflow-hidden">
<!-- User Mini Profile -->
<div class="p-4 border-b border-border-light dark:border-border-dark flex items-center gap-3">
<div class="h-12 w-12 rounded-full bg-cover bg-center" data-alt="Small user avatar" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuDdIomlLLC3pwGX8IO1qiIwxfaewi8zik9ygkn6fO-x9YxqErYZjy6HCH9VJq5jLAkcJCGoiKx1z7hYyI6SXu-ZSkATPlQR9ybZNj-bwvDGpm4iTAX_ebuUj1gBM4BNVDklnp18P_ECmQqTRkMAyUnQplV5E_WP7K6u5DiW-PoYMjzZh_hucMV-7E_MIQRgek1HCN7HNPo0oxos35MpaGX25uN40YRaoe1tNpMT9QCPZQDdytdgl-a4MTUOms_ffs8E8Hc4GNABuQ");'></div>
<div class="flex flex-col">
<span class="text-sm font-bold text-text-main-light dark:text-text-main-dark">Budi Santoso</span>
<div class="flex items-center gap-1">
<span class="material-symbols-outlined text-xs text-yellow-500 fill-current">stars</span>
<span class="text-xs text-text-sub-light dark:text-text-sub-dark">Member Gold</span>
</div>
</div>
</div>
<!-- Navigation Menu -->
<div class="p-2">
<a class="flex items-center gap-3 px-3 py-2.5 rounded-lg bg-primary/10 text-primary font-medium transition-colors" href="#">
<span class="material-symbols-outlined text-[20px]">person</span>
<span class="text-sm">Biodata Diri</span>
</a>
<a class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-text-main-light dark:text-text-main-dark hover:bg-background-light dark:hover:bg-background-dark transition-colors group" href="#">
<span class="material-symbols-outlined text-[20px] text-text-sub-light dark:text-text-sub-dark group-hover:text-primary">location_on</span>
<span class="text-sm font-medium">Daftar Alamat</span>
</a>
<a class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-text-main-light dark:text-text-main-dark hover:bg-background-light dark:hover:bg-background-dark transition-colors group" href="#">
<span class="material-symbols-outlined text-[20px] text-text-sub-light dark:text-text-sub-dark group-hover:text-primary">credit_card</span>
<span class="text-sm font-medium">Pembayaran</span>
</a>
<a class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-text-main-light dark:text-text-main-dark hover:bg-background-light dark:hover:bg-background-dark transition-colors group" href="#">
<span class="material-symbols-outlined text-[20px] text-text-sub-light dark:text-text-sub-dark group-hover:text-primary">inventory_2</span>
<span class="text-sm font-medium">Riwayat Pesanan</span>
</a>
<div class="my-2 border-t border-border-light dark:border-border-dark"></div>
<a class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-text-main-light dark:text-text-main-dark hover:bg-background-light dark:hover:bg-background-dark transition-colors group" href="#">
<span class="material-symbols-outlined text-[20px] text-text-sub-light dark:text-text-sub-dark group-hover:text-primary">settings</span>
<span class="text-sm font-medium">Pengaturan</span>
</a>
</div>
</div>
</aside>
<!-- Main Content Area -->
<div class="flex-1 min-w-0 space-y-6">
<!-- Profile Header Card -->
<div class="bg-surface-light dark:bg-surface-dark rounded-xl shadow-sm border border-border-light dark:border-border-dark p-6">
<div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-6">
<div class="flex items-center gap-6">
<div class="relative group cursor-pointer">
<div class="h-24 w-24 rounded-full bg-cover bg-center border-4 border-background-light dark:border-background-dark shadow-sm" data-alt="Large user avatar" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuD9LM9O6961JCcoXcOR6bYzbDfw2eJXjV8E2aS7LVt2xp8gz1YwgDQFYJWR-X3D4--shLfonRO67rE5KXzzmP03vWNeKli7eQCfSL46wQUixzqryf8xoMhJghobgN2HM-2BTQdanJaC6jwcfRnkxmdFUT71OouhGGMD2536myUowPxapoSYthMY92suQo08dWTWRPhn33Qcxyk_aD70z3qVi3Ja-SPYotljOXU3ppSfiZCeBNeRBAluadNI3GHaHqXBGzyQbT-ECg");'></div>
<div class="absolute bottom-0 right-0 p-1.5 bg-primary rounded-full text-white shadow-sm border-2 border-white dark:border-surface-dark group-hover:scale-110 transition-transform">
<span class="material-symbols-outlined text-[16px] block">edit</span>
</div>
</div>
<div>
<h2 class="text-xl font-bold text-text-main-light dark:text-text-main-dark">Budi Santoso</h2>
<p class="text-text-sub-light dark:text-text-sub-dark text-sm mt-1">Bergabung sejak 24 Maret 2021</p>
<div class="mt-3 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400">
                                    Akun Terverifikasi
                                </div>
</div>
</div>
<button class="w-full sm:w-auto px-4 py-2 bg-background-light dark:bg-background-dark hover:bg-gray-100 dark:hover:bg-gray-800 text-text-main-light dark:text-text-main-dark rounded-lg text-sm font-bold border border-border-light dark:border-border-dark transition-colors">
                            Ubah Foto Profil
                        </button>
</div>
</div>
<!-- Form Section -->
<div class="bg-surface-light dark:bg-surface-dark rounded-xl shadow-sm border border-border-light dark:border-border-dark overflow-hidden">
<div class="px-6 py-4 border-b border-border-light dark:border-border-dark flex justify-between items-center">
<h3 class="text-lg font-bold text-text-main-light dark:text-text-main-dark">Ubah Biodata Diri</h3>
<span class="text-xs text-text-sub-light dark:text-text-sub-dark">Terakhir diupdate: 2 hari yang lalu</span>
</div>
<div class="p-6">
<form action="#" class="space-y-6">
<!-- Name & Username -->
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
<div class="space-y-2">
<label class="block text-sm font-medium text-text-main-light dark:text-text-main-dark" for="fullname">
                                        Nama Lengkap
                                    </label>
<input class="block w-full rounded-lg border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-main-light dark:text-text-main-dark text-sm focus:ring-primary focus:border-primary px-4 py-2.5" id="fullname" placeholder="Masukkan nama lengkap" type="text" value="Budi Santoso"/>
<p class="text-xs text-text-sub-light dark:text-text-sub-dark">Nama akan ditampilkan di profil publik.</p>
</div>
<div class="space-y-2">
<label class="block text-sm font-medium text-text-main-light dark:text-text-main-dark" for="username">
                                        Username
                                    </label>
<div class="flex rounded-lg shadow-sm">
<span class="inline-flex items-center px-3 rounded-l-lg border border-r-0 border-border-light dark:border-border-dark bg-gray-50 dark:bg-surface-dark text-text-sub-light dark:text-text-sub-dark text-sm">
                                            @
                                        </span>
<input class="flex-1 block w-full rounded-none rounded-r-lg border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-main-light dark:text-text-main-dark text-sm focus:ring-primary focus:border-primary px-4 py-2.5" id="username" type="text" value="budisantoso99"/>
</div>
</div>
</div>
<!-- Date of Birth & Gender -->
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
<div class="space-y-2">
<label class="block text-sm font-medium text-text-main-light dark:text-text-main-dark">
                                        Tanggal Lahir
                                    </label>
<div class="grid grid-cols-3 gap-2">
<select class="rounded-lg border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-main-light dark:text-text-main-dark text-sm focus:ring-primary focus:border-primary">
<option>12</option>
</select>
<select class="rounded-lg border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-main-light dark:text-text-main-dark text-sm focus:ring-primary focus:border-primary">
<option>Agustus</option>
</select>
<select class="rounded-lg border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-main-light dark:text-text-main-dark text-sm focus:ring-primary focus:border-primary">
<option>1995</option>
</select>
</div>
</div>
<div class="space-y-2">
<label class="block text-sm font-medium text-text-main-light dark:text-text-main-dark">
                                        Jenis Kelamin
                                    </label>
<div class="flex gap-4">
<label class="flex items-center gap-2 cursor-pointer">
<input checked="" class="text-primary focus:ring-primary border-gray-300 dark:border-gray-600 bg-transparent" name="gender" type="radio"/>
<span class="text-sm text-text-main-light dark:text-text-main-dark">Laki-laki</span>
</label>
<label class="flex items-center gap-2 cursor-pointer">
<input class="text-primary focus:ring-primary border-gray-300 dark:border-gray-600 bg-transparent" name="gender" type="radio"/>
<span class="text-sm text-text-main-light dark:text-text-main-dark">Perempuan</span>
</label>
</div>
</div>
</div>
<hr class="border-border-light dark:border-border-dark"/>
<!-- Contact Info -->
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
<div class="space-y-2">
<label class="block text-sm font-medium text-text-main-light dark:text-text-main-dark">
                                        Email
                                    </label>
<div class="relative">
<input class="block w-full rounded-lg border-border-light dark:border-border-dark bg-gray-50 dark:bg-surface-dark text-text-sub-light dark:text-text-sub-dark text-sm px-4 py-2.5 cursor-not-allowed" disabled="" type="email" value="budi.santoso@gmail.com"/>
<span class="absolute right-3 top-2.5 text-xs font-bold text-green-600 flex items-center gap-1">
<span class="material-symbols-outlined text-[16px]">check_circle</span>
                                            Terverifikasi
                                        </span>
</div>
<a class="text-xs font-medium text-primary hover:underline" href="#">Ubah Email</a>
</div>
<div class="space-y-2">
<label class="block text-sm font-medium text-text-main-light dark:text-text-main-dark">
                                        Nomor HP
                                    </label>
<div class="relative">
<input class="block w-full rounded-lg border-border-light dark:border-border-dark bg-gray-50 dark:bg-surface-dark text-text-sub-light dark:text-text-sub-dark text-sm px-4 py-2.5 cursor-not-allowed" disabled="" type="text" value="+62 812 3456 7890"/>
<span class="absolute right-3 top-2.5 text-xs font-bold text-green-600 flex items-center gap-1">
<span class="material-symbols-outlined text-[16px]">check_circle</span>
                                            Terverifikasi
                                        </span>
</div>
<a class="text-xs font-medium text-primary hover:underline" href="#">Ubah Nomor HP</a>
</div>
</div>
</form>
</div>
<!-- Footer Actions -->
<div class="px-6 py-4 bg-background-light dark:bg-background-dark border-t border-border-light dark:border-border-dark flex items-center justify-end gap-3">
<button class="px-6 py-2.5 rounded-lg text-sm font-bold text-text-sub-light dark:text-text-sub-dark hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">
                            Batal
                        </button>
<button class="px-6 py-2.5 rounded-lg bg-primary hover:bg-orange-600 text-white text-sm font-bold shadow-sm shadow-orange-500/30 transition-all transform active:scale-95">
                            Simpan Perubahan
                        </button>
</div>
</div>
<!-- Recent Order / Snippet Section (To fulfill requirement to see orders) -->
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
<!-- Primary Address Preview -->
<div class="bg-surface-light dark:bg-surface-dark rounded-xl shadow-sm border border-border-light dark:border-border-dark p-6">
<div class="flex justify-between items-center mb-4">
<h3 class="text-base font-bold text-text-main-light dark:text-text-main-dark">Alamat Utama</h3>
<a class="text-sm font-medium text-primary hover:underline" href="#">Lihat Semua</a>
</div>
<div class="p-4 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark">
<div class="flex items-start gap-3">
<span class="material-symbols-outlined text-text-sub-light mt-0.5">home</span>
<div>
<p class="text-sm font-bold text-text-main-light dark:text-text-main-dark">Rumah (Budi Santoso)</p>
<p class="text-sm text-text-sub-light dark:text-text-sub-dark mt-1 leading-relaxed">
                                        Jl. Sudirman No. 45, Komplek Green Garden, Blok C2<br/>
                                        Jakarta Selatan, DKI Jakarta 12930<br/>
<span class="text-xs">+62 812 3456 7890</span>
</p>
</div>
</div>
</div>
</div>
<!-- Last Order Preview -->
<div class="bg-surface-light dark:bg-surface-dark rounded-xl shadow-sm border border-border-light dark:border-border-dark p-6">
<div class="flex justify-between items-center mb-4">
<h3 class="text-base font-bold text-text-main-light dark:text-text-main-dark">Pesanan Terakhir</h3>
<a class="text-sm font-medium text-primary hover:underline" href="#">Riwayat</a>
</div>
<div class="p-4 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark">
<div class="flex items-center gap-4">
<div class="h-16 w-16 rounded-lg bg-white dark:bg-surface-dark p-1 border border-border-light dark:border-border-dark flex-shrink-0">
<div class="w-full h-full bg-cover bg-center rounded" data-alt="Coffee beans product image" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuAJliZ1UJ3J0675xbEaQlwc-TJoy5jR7GDLWGJ9dewIu3meYq0kGW9271CxFZrqAB2VSnM7fdXp0y54JXwTibomMgPbCXa1WPOhlJHngt3szZNFFIscNM18NJXP35T6sFRZE3tGfbMPE5QlePWbKFKeXDKNuZxYINtQ979Gc0fONMmMLcYEtmZvO-OH5QvHGKgqignlWmt1jUtu3-1yKWk11t4-wh4AkCh24Gyt0uKJMWc9jtj4unAVa4P4ogFIppVQ5mcHzBiBGw");'></div>
</div>
<div class="flex-1 min-w-0">
<p class="text-sm font-bold text-text-main-light dark:text-text-main-dark truncate">Arabica Gayo Premium 500g</p>
<p class="text-xs text-text-sub-light dark:text-text-sub-dark mt-0.5">24 Des 2023</p>
<div class="mt-2 flex items-center gap-2">
<span class="inline-flex items-center px-2 py-0.5 rounded text-[10px] font-bold bg-green-100 text-green-700 dark:bg-green-900/40 dark:text-green-400">
                                            Selesai
                                        </span>
<span class="text-xs font-semibold text-primary">Rp 125.000</span>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</main>

<script src="config.js"></script>
<script>
const API_URL = CONFIG.API_BASE_URL;

// Load user profile data
async function loadProfile() {
    const token = localStorage.getItem('token');
    
    if (!token) {
        alert('Silakan login terlebih dahulu');
        window.location.href = 'login.html';
        return;
    }
    
    try {
        const res = await fetch(`${API_URL}/profile`, {
            method: 'GET',
            headers: {
                'Authorization': `Bearer ${token}`,
                'Accept': 'application/json'
            }
        });
        
        if (!res.ok) {
            if (res.status === 401) {
                localStorage.removeItem('token');
                alert('Sesi Anda telah berakhir. Silakan login kembali.');
                window.location.href = 'login.html';
            }
            throw new Error('Gagal memuat profil');
        }
        
        const data = await res.json();
        const profile = data.data || data;
        
        // Update form dengan data user
        const inputs = document.querySelectorAll('input[type="text"], input[type="email"], input[type="date"]');
        
        inputs.forEach(input => {
            const name = input.getAttribute('name') || input.getAttribute('placeholder') || '';
            
            if (name.includes('email') || input.type === 'email') {
                input.value = profile.email || '';
            } else if (name.includes('first') || name.includes('Depan')) {
                input.value = profile.first_name || '';
            } else if (name.includes('last') || name.includes('Belakang')) {
                input.value = profile.last_name || '';
            } else if (name.includes('date') || input.type === 'date') {
                input.value = profile.birth_date || '';
            } else if (name.includes('phone') || name.includes('hp')) {
                input.value = profile.phone || '';
            }
        });
        
        // Update user name di header
        const nameElements = document.querySelectorAll('span[class*="font-semibold"], span[class*="font-bold"]');
        nameElements.forEach(el => {
            if (el.textContent.includes('Budi') || el.textContent.match(/[A-Z]/)) {
                el.textContent = `${profile.first_name || ''} ${profile.last_name || ''}`.trim() || 'User';
            }
        });
        
    } catch (err) {
        console.error('Error loading profile:', err);
        alert('Gagal memuat profil: ' + err.message);
    }
}

// Save profile changes
function setupSaveButton() {
    const saveBtn = Array.from(document.querySelectorAll('button')).find(btn => 
        btn.textContent.includes('Simpan')
    );
    
    if (saveBtn) {
        saveBtn.setAttribute('type', 'button');
        saveBtn.addEventListener('click', async function(e) {
            e.preventDefault();
            e.stopPropagation();
            
            const token = localStorage.getItem('token');
            
            try {
                // Collect form data
                const inputs = document.querySelectorAll('input[type="text"], input[type="email"], input[type="date"]');
                const formData = {};
                
                inputs.forEach(input => {
                    const name = input.getAttribute('name') || input.getAttribute('placeholder') || '';
                    
                    if (name.includes('email') || input.type === 'email') {
                        formData.email = input.value;
                    } else if (name.includes('first') || name.includes('Depan')) {
                        formData.first_name = input.value;
                    } else if (name.includes('last') || name.includes('Belakang')) {
                        formData.last_name = input.value;
                    } else if (name.includes('date') || input.type === 'date') {
                        formData.birth_date = input.value;
                    } else if (name.includes('phone') || name.includes('hp')) {
                        formData.phone = input.value;
                    }
                });
                
                // Get gender
                const genderInput = document.querySelector('input[name="gender"]:checked');
                if (genderInput) {
                    formData.gender = genderInput.value;
                }
                
                const res = await fetch(`${API_URL}/profile`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`,
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });
                
                if (!res.ok) {
                    const error = await res.json();
                    throw new Error(error.message || 'Gagal menyimpan profil');
                }
                
                alert('Profil berhasil diperbarui!');
                loadProfile();
                
            } catch (err) {
                alert('Error: ' + err.message);
                console.error(err);
            }
        });
    }
}

// Setup Cancel Button
function setupCancelButton() {
    const cancelBtn = Array.from(document.querySelectorAll('button')).find(btn => 
        btn.textContent.includes('Batal')
    );
    
    if (cancelBtn) {
        cancelBtn.addEventListener('click', function(e) {
            e.preventDefault();
            window.location.href = 'Halaman.beranda.html';
        });
    }
}

// Setup Navigation
function setupNavigation() {
    // Logo
    const logoBtn = document.querySelector('a.flex.items-center.gap-2');
    if (logoBtn) {
        logoBtn.addEventListener('click', function(e) {
            e.preventDefault();
            window.location.href = 'Halaman.beranda.html';
        });
    }
    
    // Cart button
    const cartBtn = document.querySelector('button[class*="p-2"] span.material-symbols-outlined');
    if (cartBtn && cartBtn.textContent.includes('shopping_cart')) {
        cartBtn.closest('button')?.addEventListener('click', function(e) {
            e.preventDefault();
            window.location.href = 'halaman.keranjang.belanja.html';
        });
    }
}

document.addEventListener('DOMContentLoaded', function() {
    // Check authentication
    const token = localStorage.getItem('token');
    if (!token) {
        window.location.href = 'login.html';
        return;
    }
    
    loadProfile();
    setupSaveButton();
    setupCancelButton();
    setupNavigation();
});
</script>

</body></html>